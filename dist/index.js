"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var h=e(require("lodash.times")),p=require("timestamp-utils"),t=require("react"),y=e(t),a=require("prop-types"),n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},C=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(e){e=e||(new Date).getTime();var t=p.getDay(e),a=p.addDays(e,1-t),n=p.addMonths(p.addDays(a,-1),1),r=p.getWeekDay(a);return{firstMonthDay:a,lastMonthDay:n,firstDayToDisplay:p.addDays(a,-r),month:parseInt(p.getMonth(e),10),year:p.getYear(e)}},i=function(e,t,a){return{startDate:t&&a?Math.min(e,t):e,endDate:t&&a&&!M(t,e)?Math.max(e,t):null}},O=function(e){var t=p.decompose(e),a=C(t,7);return p.add(e,{hours:-a[3],minutes:-a[4],seconds:-a[5],milliseconds:-a[6]})},M=function(e,t){return O(e)===O(t)},c=function(e){return("0"+e).slice(-2)},l=function(e,t){if(!e||!t)return t;var a=O(t),n=p.decompose(e),r=C(n,7),s=r[4],o=r[5],i=r[6];return p.add(a,{hours:parseInt(r[3],10),minutes:parseInt(s,10),seconds:parseInt(o,10),milliseconds:parseInt(i,10)})},u=function(e){function a(e){n(this,a);var t=s(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return d.call(t),t.state=t.extractTime(e),t}return r(a,t.Component),a}(),d=function(){var l=this;this.componentWillReceiveProps=function(e){return l.setState(l.extractTime(e))},this.extractTime=function(e){var t=new Date(e.date);return{hours:t.getHours(),minutes:t.getMinutes()}},this.onHoursChange=function(e){var t=l.props;(0,t.onTimeChange)(new Date(t.date).setHours(e.target.value))},this.onMinutesChange=function(e){var t=l.props;(0,t.onTimeChange)(new Date(t.date).setMinutes(e.target.value))},this.render=function(){var e=l.props,t=e.date,a=e.displayTime,n=e.dayLabels,r=e.monthLabels,s=l.state,o=s.hours,i=s.minutes;return y.createElement("div",{className:"rlc-date-details-wrapper"},y.createElement("div",{className:"rlc-date-details"},y.createElement("div",{className:"rlc-date-number"},t.getDate()),y.createElement("div",{className:"rlc-date-day-month-year"},y.createElement("div",{className:"rlc-detail-day"},n[(t.getDay()||7)-1]),y.createElement("div",{className:"rlc-detail-month-year"},r[t.getMonth()]," ",y.createElement("span",{className:"rlc-detail-year"},t.getFullYear())))),a&&y.createElement("div",{className:"rlc-date-time-selects"},y.createElement("select",{onChange:l.onHoursChange,value:o},h(24).map(function(e){return y.createElement("option",{value:e,key:e},c(e))})),y.createElement("span",{className:"rlc-time-separator"},":"),y.createElement("select",{onChange:l.onMinutesChange,value:i},h(60).map(function(e){return y.createElement("option",{value:e,key:e},c(e))}))))}};function v(e){var t=e.startDate,a=e.endDate,n=e.dayLabels,r=e.monthLabels,s=e.displayTime,o=e.onStartTimeChange,i=e.onEndTimeChange;return y.createElement("div",{className:"rlc-details"},t&&y.createElement(u,{dayLabels:n,monthLabels:r,date:new Date(t),displayTime:s,onTimeChange:o}),a&&y.createElement(u,{dayLabels:n,monthLabels:r,date:new Date(a),displayTime:s,onTimeChange:i}))}u.propTypes={date:a.instanceOf(Date),displayTime:a.bool,dayLabels:a.arrayOf(a.string),monthLabels:a.arrayOf(a.string),onTimeChange:a.func},v.propTypes={startDate:a.number,endDate:a.number,dayLabels:a.arrayOf(a.string),monthLabels:a.arrayOf(a.string),displayTime:a.bool,onStartTimeChange:a.func,onEndTimeChange:a.func};var b=function(e){var t=e.monthLabels,a=e.month,n=e.year,r=e.prevMonth,s=e.nextYear,o=e.nextMonth;return y.createElement("div",{className:"rlc-month-and-year-wrapper"},y.createElement("div",{className:"rlc-navigation-button-wrapper rlc-prevs"},y.createElement("div",{className:"rlc-navigation-button rlc-prev-year",onClick:e.prevYear},"<<"),y.createElement("div",{className:"rlc-navigation-button rlc-prev-month",onClick:r},"<")),y.createElement("div",{className:"rlc-month-and-year"},t[a-1]," ",y.createElement("span",null,n)),y.createElement("div",{className:"rlc-navigation-button-wrapper rlc-nexts"},y.createElement("div",{className:"rlc-navigation-button rlc-next-month",onClick:o},">"),y.createElement("div",{className:"rlc-navigation-button rlc-next-year",onClick:s},">>")))};b.propTypes={monthLabels:a.arrayOf(a.string),month:a.number,year:a.string,prevYear:a.func,prevMonth:a.func,nextYear:a.func,nextMonth:a.func};var m=function(e){function a(e){n(this,a);var t=s(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return g.call(t),t.state=f({},o(e.startDate),i(e.startDate,e.endDate,e.range)),t}return r(a,t.Component),a}(),g=function(){var E=this;this.componentWillReceiveProps=function(e){return E.setState(i(e.startDate,e.endDate,e.range))},this.onClickDay=function(e){var t=E.props.range,a=E.state,n=a.startDate;E.update(t?n?n&&!a.endDate?i(n,e,t):{startDate:l(n,e),endDate:null}:{startDate:e}:{startDate:l(n,e),endDate:null})},this.onStartTimeChange=function(e){return E.update({startDate:e})},this.onEndTimeChange=function(e){return E.update({endDate:e})},this.changeMonth=function(e){var t=e.yearOffset,a=e.monthOffset,n=p.add(E.state.firstMonthDay,{months:void 0===a?0:a,years:void 0===t?0:t});E.setState(o(n))},this.prevYear=function(){return E.changeMonth({yearOffset:-1})},this.prevMonth=function(){return E.changeMonth({monthOffset:-1})},this.nextYear=function(){return E.changeMonth({yearOffset:1})},this.nextMonth=function(){return E.changeMonth({monthOffset:1})},this.update=function(e){var t=e.startDate,a=e.endDate;E.props.onChange(void 0===t?E.props.startDate:t,void 0===a?E.props.endDate:a)},this.getClassNames=function(e){var t,a,n,r,s,o,i,l,c,u,d,m,h,p,y,f=E.state,v=f.firstMonthDay,b=f.lastMonthDay,g=f.startDate,D=f.endDate,T=(t={"rlc-day-disabled":(0,E.props.disableDates)(e),"rlc-day-today":M(e,O((new Date).getTime())),"rlc-day-inside-selection":(u=e,d=g,m=D,h=O(u),p=O(d),y=O(m),p<h&&h<y),"rlc-day-out-of-month":(r=e,s=v,o=b,i=O(r),l=O(s),c=O(o),i<l||c<i),"rlc-day-selected":!D&&M(g,e),"rlc-day-start-selection":D&&M(g,e),"rlc-day-end-selection":D&&M(D,e)},n=!0,(a="rlc-day-"+e)in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t);return Object.entries(T).reduce(function(e,t){var a=C(t,2);return a[1]?e+" "+a[0]:e},"")||"Day_default"},this.render=function(){var t,e=E.state,a=e.firstDayToDisplay,n=e.startDate,r=e.endDate,s=e.month,o=e.year,i=E.props,l=i.disableDates,c=i.displayTime,u=i.dayLabels,d=i.monthLabels,m=function(e,t){var a={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(i,["startDate","endDate","onChange","range","disableDates","displayTime","dayLabels","monthLabels"]);return y.createElement("div",f({className:"rlc-calendar"},m),y.createElement(v,{startDate:n,endDate:r,dayLabels:u,monthLabels:d,displayTime:c,onStartTimeChange:E.onStartTimeChange,onEndTimeChange:E.onEndTimeChange}),y.createElement(b,{monthLabels:d,month:s,year:o,prevYear:E.prevYear,prevMonth:E.prevMonth,nextYear:E.nextYear,nextMonth:E.nextMonth}),y.createElement("div",{className:"rlc-days-label"},u.map(function(e){return y.createElement("div",{className:"rlc-day-label",key:e.toLowerCase()},e.slice(0,2))})),y.createElement("div",{className:"rlc-days"},(t=a,h(42,function(e){return p.addDays(t,e)})).map(function(e){return y.createElement("div",{className:"rlc-day "+E.getClassNames(e),key:e,onClick:function(){return!l(e)&&E.onClickDay(e)}},new Date(e).getDate())})))}};m.defaultProps={startDate:null,endDate:null,onChange:function(){},range:!1,disableDates:function(){return!1},displayTime:!1,dayLabels:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"]},m.propTypes={startDate:a.number,endDate:a.number,onChange:a.func,range:a.bool,disableDates:a.func,displayTime:a.bool,dayLabels:a.arrayOf(a.string).isRequired,monthLabels:a.arrayOf(a.string).isRequired},module.exports=m;
